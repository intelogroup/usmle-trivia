/**
 * Advanced Accessibility Styles
 * WCAG 2.1 AA compliant styles for enhanced accessibility features
 */

/* =============================================================================
   Screen Reader Only Content
   ============================================================================= */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.sr-only:focus,
.sr-only:active {
  position: static;
  width: auto;
  height: auto;
  padding: 0.5rem;
  margin: 0;
  overflow: visible;
  clip: auto;
  white-space: normal;
  background: #000;
  color: #fff;
  border: 2px solid #fff;
  border-radius: 4px;
  font-size: 1rem;
  z-index: 9999;
}

/* =============================================================================
   High Contrast Mode
   ============================================================================= */
.accessibility-high-contrast {
  /* Enhanced contrast for text */
  --foreground: 0 0% 0%;
  --background: 0 0% 100%;
  --muted: 0 0% 20%;
  --muted-foreground: 0 0% 0%;
  --border: 0 0% 0%;
  --input: 0 0% 100%;
  
  /* High contrast colors for interactive elements */
  --primary: 220 100% 25%; /* Dark blue */
  --primary-foreground: 0 0% 100%;
  --secondary: 0 0% 15%;
  --secondary-foreground: 0 0% 100%;
  
  /* Medical content colors with high contrast */
  --medical-anatomy: 0 85% 35%; /* Dark red */
  --medical-physiology: 210 85% 35%; /* Dark blue */
  --medical-pathology: 45 85% 35%; /* Dark yellow/orange */
  --medical-pharmacology: 270 85% 35%; /* Dark purple */
  --medical-microbiology: 120 85% 35%; /* Dark green */
  
  /* Alert colors with high contrast */
  --destructive: 0 75% 30%;
  --destructive-foreground: 0 0% 100%;
  --warning: 38 75% 30%;
  --warning-foreground: 0 0% 100%;
  --success: 120 75% 30%;
  --success-foreground: 0 0% 100%;
}

.accessibility-high-contrast * {
  /* Remove subtle shadows and gradients */
  box-shadow: none !important;
  background-image: none !important;
  text-shadow: none !important;
}

.accessibility-high-contrast button,
.accessibility-high-contrast .btn {
  border: 2px solid currentColor !important;
  background: var(--primary) !important;
  color: var(--primary-foreground) !important;
}

.accessibility-high-contrast button:hover,
.accessibility-high-contrast .btn:hover {
  background: var(--secondary) !important;
  color: var(--secondary-foreground) !important;
}

.accessibility-high-contrast input,
.accessibility-high-contrast select,
.accessibility-high-contrast textarea {
  border: 2px solid var(--border) !important;
  background: var(--background) !important;
  color: var(--foreground) !important;
}

.accessibility-high-contrast .card {
  border: 2px solid var(--border) !important;
  background: var(--background) !important;
}

/* =============================================================================
   Large Text Mode  
   ============================================================================= */
.accessibility-large-text {
  font-size: 1.25rem !important; /* 20px base instead of 16px */
}

.accessibility-large-text h1 { font-size: 3rem !important; }
.accessibility-large-text h2 { font-size: 2.5rem !important; }
.accessibility-large-text h3 { font-size: 2rem !important; }
.accessibility-large-text h4 { font-size: 1.75rem !important; }
.accessibility-large-text h5 { font-size: 1.5rem !important; }
.accessibility-large-text h6 { font-size: 1.25rem !important; }

.accessibility-large-text .text-sm { font-size: 1rem !important; }
.accessibility-large-text .text-xs { font-size: 0.875rem !important; }
.accessibility-large-text .text-lg { font-size: 1.5rem !important; }
.accessibility-large-text .text-xl { font-size: 1.75rem !important; }
.accessibility-large-text .text-2xl { font-size: 2.25rem !important; }
.accessibility-large-text .text-3xl { font-size: 3.5rem !important; }

.accessibility-large-text button,
.accessibility-large-text .btn {
  padding: 1rem 1.5rem !important;
  font-size: 1.25rem !important;
}

.accessibility-large-text input,
.accessibility-large-text select,
.accessibility-large-text textarea {
  padding: 1rem !important;
  font-size: 1.25rem !important;
}

/* =============================================================================
   Reduced Motion
   ============================================================================= */
.accessibility-reduced-motion,
.accessibility-reduced-motion *,
.accessibility-reduced-motion *:before,
.accessibility-reduced-motion *:after {
  animation-duration: 0.01ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 0.01ms !important;
  transform: none !important;
}

.accessibility-reduced-motion .animate-spin {
  animation: none !important;
}

.accessibility-reduced-motion .animate-pulse {
  animation: none !important;
}

/* Still allow focus transitions for accessibility */
.accessibility-reduced-motion *:focus {
  transition: outline 0.15s ease !important;
}

/* =============================================================================
   Enhanced Focus Indicators
   ============================================================================= */
.accessibility-focus-enhanced *:focus {
  outline: 3px solid #005fcc !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 5px rgba(0, 95, 204, 0.3) !important;
}

.accessibility-focus-high-contrast *:focus {
  outline: 4px solid #000 !important;
  outline-offset: 3px !important;
  background-color: #ffff00 !important;
  color: #000 !important;
  box-shadow: 0 0 0 7px #ffff00 !important;
}

/* =============================================================================
   Color Blindness Support
   ============================================================================= */

/* Deuteranopia (Green-blind) */
.accessibility-deuteranopia {
  filter: url('#deuteranopia-filter');
}

/* Protanopia (Red-blind) */  
.accessibility-protanopia {
  filter: url('#protanopia-filter');
}

/* Tritanopia (Blue-blind) */
.accessibility-tritanopia {
  filter: url('#tritanopia-filter');
}

/* Alternative approach using CSS filters for color blindness */
@media (prefers-contrast: high) {
  .accessibility-deuteranopia {
    filter: contrast(150%) brightness(110%) hue-rotate(90deg);
  }
  
  .accessibility-protanopia {
    filter: contrast(150%) brightness(110%) hue-rotate(-90deg);
  }
  
  .accessibility-tritanopia {
    filter: contrast(150%) brightness(110%) saturate(150%);
  }
}

/* =============================================================================
   Medical Content Accessibility
   ============================================================================= */

/* Medical term highlighting for screen readers */
.medical-term {
  position: relative;
  border-bottom: 1px dotted currentColor;
}

.medical-term:hover::after,
.medical-term:focus::after {
  content: attr(data-definition);
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background: #000;
  color: #fff;
  padding: 0.5rem;
  border-radius: 4px;
  white-space: nowrap;
  font-size: 0.875rem;
  z-index: 1000;
}

/* Medical abbreviation expansions */
.medical-abbrev {
  text-decoration: underline dotted;
  cursor: help;
}

.medical-abbrev:hover::after,
.medical-abbrev:focus::after {
  content: attr(data-expansion);
  position: absolute;
  bottom: 100%;
  left: 0;
  background: var(--popover);
  color: var(--popover-foreground);
  padding: 0.5rem;
  border: 1px solid var(--border);
  border-radius: 4px;
  font-size: 0.875rem;
  white-space: nowrap;
  z-index: 1000;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* =============================================================================
   Quiz-Specific Accessibility Enhancements
   ============================================================================= */

/* Enhanced question numbering for screen readers */
.question-number::before {
  content: "Question number ";
  position: absolute;
  left: -9999px;
}

/* Answer option enhancements */
.quiz-option {
  position: relative;
}

.quiz-option::before {
  content: "Option " attr(data-option-letter) ": ";
  position: absolute;
  left: -9999px;
}

.quiz-option[aria-checked="true"]::after {
  content: " (Selected)";
  position: absolute;
  left: -9999px;
}

.quiz-option.correct::after {
  content: " (Correct Answer)";
  position: absolute;
  left: -9999px;
}

.quiz-option.incorrect::after {
  content: " (Incorrect Answer)";
  position: absolute;
  left: -9999px;
}

/* Timer accessibility */
.quiz-timer[aria-live="polite"] {
  /* Ensure timer updates are announced but not too frequently */
}

.quiz-timer.critical {
  /* Visual indication for critical time remaining */
  border: 2px solid #dc2626;
  background: #fef2f2;
  color: #dc2626;
}

.quiz-timer.critical::before {
  content: "Warning: ";
  font-weight: bold;
}

/* =============================================================================
   Progress and Status Indicators
   ============================================================================= */

.progress-bar {
  position: relative;
}

.progress-bar::after {
  content: attr(aria-valuenow) "% complete";
  position: absolute;
  left: -9999px;
}

/* Status announcements */
.status-announcement {
  position: absolute;
  left: -9999px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

/* =============================================================================
   Keyboard Navigation Enhancements
   ============================================================================= */

/* Skip links */
.skip-link {
  position: absolute;
  top: -40px;
  left: 6px;
  background: #000;
  color: #fff;
  padding: 8px;
  text-decoration: none;
  border-radius: 0 0 4px 4px;
  z-index: 9999;
}

.skip-link:focus {
  top: 0;
}

/* Keyboard shortcut indicators */
.kbd {
  background: #f3f4f6;
  border: 1px solid #d1d5db;
  border-radius: 3px;
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
  display: inline-block;
  font-family: monospace;
  font-size: 0.85em;
  padding: 2px 6px;
  line-height: 1;
}

.accessibility-high-contrast .kbd {
  background: var(--background);
  border: 2px solid var(--border);
  color: var(--foreground);
}

/* =============================================================================
   Print Styles for Accessibility
   ============================================================================= */
@media print {
  .sr-only {
    position: static !important;
    width: auto !important;
    height: auto !important;
    padding: 0 !important;
    margin: 0 !important;
    overflow: visible !important;
    clip: auto !important;
    white-space: normal !important;
    font-size: 12pt;
  }
  
  /* Show alternative text for images */
  img::after {
    content: " (Alt text: " attr(alt) ")";
    display: inline;
    font-size: 10pt;
    color: #666;
  }
  
  /* Show URLs for links */
  a::after {
    content: " (" attr(href) ")";
    font-size: 10pt;
    color: #666;
  }
}

/* =============================================================================
   Responsive Accessibility
   ============================================================================= */
@media (max-width: 768px) {
  .accessibility-large-text {
    font-size: 1.125rem !important; /* Slightly smaller on mobile */
  }
  
  .accessibility-focus-enhanced *:focus,
  .accessibility-focus-high-contrast *:focus {
    outline-offset: 1px !important; /* Smaller offset on mobile */
  }
  
  /* Touch target size compliance (minimum 44x44px) */
  button, 
  a,
  .clickable {
    min-height: 44px;
    min-width: 44px;
  }
}

/* =============================================================================
   Dark Mode Accessibility
   ============================================================================= */
@media (prefers-color-scheme: dark) {
  .accessibility-high-contrast {
    --foreground: 0 0% 100%;
    --background: 0 0% 0%;
    --muted: 0 0% 80%;
    --muted-foreground: 0 0% 100%;
    --border: 0 0% 100%;
  }
  
  .sr-only:focus,
  .sr-only:active {
    background: #fff;
    color: #000;
    border-color: #000;
  }
}

/* =============================================================================
   Animation Safe Fallbacks
   ============================================================================= */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
  
  /* Exception for focus transitions */
  *:focus {
    transition-duration: 0.15s !important;
  }
}

/* =============================================================================
   High Contrast Media Query Support
   ============================================================================= */
@media (prefers-contrast: high) {
  :root {
    --primary: 0 0% 0%;
    --primary-foreground: 0 0% 100%;
    --secondary: 0 0% 20%;
    --secondary-foreground: 0 0% 100%;
  }
  
  button, .btn {
    border: 2px solid currentColor !important;
  }
}

/* =============================================================================
   SVG Color Blind Filters
   ============================================================================= */
.accessibility-svg-filters {
  position: absolute;
  width: 0;
  height: 0;
  pointer-events: none;
}

/* These would be added to the DOM via JavaScript */